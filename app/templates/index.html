{% extends "layout.html" %}

{% block title %}
    Piranha Home
{% endblock %}

{% block main %}


<div class="container">
    <!-- 'Featured card' to go at top, can display more values than most cards and change as cards are selected-->
    <div id="emptyCard" class="card mb-3 mx-auto justify-content-center" style="width:1200px; height:400px;">
        <h1> Empty Div to hold graphical data, maybe some standard readouts whilst a 'Selected Card' isn't active</h1>
    </div>
    <div id="featuredCard" class="card mb-3 mx-auto" style="width:1200px; height:400px; background-color:antiquewhite;">
        <div class="row g-0">
            <div class="col-md-4">
                <img src="/static/theplague843.png" class="img-fluid rounded-start" style="height: 400px; width: auto" alt="This should pull collection name and token id">
            </div>
            <div class="col-md-8">
                <div class="card-body">
                    <h5 class="card-title">'Selected' Card</h5>
                    <div class="card-text">
                        <p>Buy price, WETH offers on different marketplaces, potential P&L etc </p>
                        <p>Global Collection Floor: 0.24Ξ (Blur)| Global Trait Floor: 0.9Ξ (Blur)</p>
                        <p>Best Collection Offer: 0.2Ξ  (Opensea)|  Best Trait Offer: 0.39Ξ (Looksrare)</p>
                    </div>
                    <div class="d-flex align-items flex-column mb-auto">
                        <a href="https://opensea.io/assets/ethereum/0x8c3fb10693b228e8b976ff33ce88f97ce2ea9563/843" target="_blank" class="btn btn-primary"><span style="font-weight: bold;">Opensea</span><p style="font-size:smaller; margin-bottom: 0em;">Seen for 0.239Ξ  |  PNL: 0.1321Ξ (-12.5%)</p></a>
                        <a href="https://looksrare.org/collections/0x8c3FB10693B228E8b976FF33cE88f97Ce2EA9563/843" target="_blank" class="btn btn-secondary"><span style="font-weight: bold;">Next best marketplace:</span> PNL: ...Ξ<p style="font-size:smaller; margin-bottom: 0em">Seen for: ...Ξ | Best Offer: ...Ξ  | PNL: ...Ξ (-....%)</p></a>
                        <a href="https://sudoswap.xyz/#/browse/pools/0x8c3FB10693B228E8b976FF33cE88f97Ce2EA9563" target="_blank" class="btn btn-primary"><span style="font-weight: bold;">Sudoswap</span> if available, disabled if not: PNL: ...Ξ<p style="font-size:smaller; margin-bottom: 0em;">Top Pool Buys For: 0.204Ξ  | Sells For: 0.248Ξ | Liquidity In Pool: 8.748Ξ : 69 NFTs</p></a>
                        <div class="align-items-end" style="padding-top:20px">
                            <p class="card-text"><small class="text-muted p-2">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div style="text-align:center">
        <h2>Placeholders - Listings Spotted:</h2>
    </div>

    <div id="cardCarousel" class="carousel slide" data-ride="carousel" data-interval="0">
        <div class="carousel-inner">
            {% for i in range(0, all|length, 3) %}
                {% if loop.first %}
                    <div class="carousel-item active">
                {% else %}
                    <div class="carousel-item">
                {% endif %}
                <div id="deck" class="card-columns d-flex justify-content-center">
                {% for card in all[i:i+3] %}
                    {# if card is profitable, add .profitable class? and if not add .notProfitable class for styling #}
                            <div class="card miniCard" style="width: 300px">
                                <img src="{{card['image']}}" class="card-img-top" alt="{{card['name']}}">
                                <div class="card-body">
                                    <div class="button-group mt-auto d-flex flex-column mb-2">
                                        <a href="{{'https://opensea.io/assets/ethereum/%s/%s/' % (card['address'], card['token'])}}" target="_blank" class="btn btn-primary">View on Opensea</a>
                                        {# if card is profitable, make green, if not make red, can also do this with the border #}
                                        <!-- <a href="" target="_blank" class="btn btn-danger"></a> -->
                                    </div>
                                    <h5 class="card-title" style="font-weight:bold">{{card['name']}}</h5>
                                    <div class="card-text-container" style="max-height:10rem; overflow:hidden;">
                                        <p class="card-text">NFT info, prices etc
                                            {{card['slug']}}
                                            {{'https://opensea.io/assets/ethereum/%s/%s/' % (card['address'], card['token'])}}
                                            
                                        </p>
                                    </div>
                                    <a id="show-more" style="display:none;">Show More</a>
                                    <a id="show-less" style="display:none;">Show Less</a>
                                </div>
                            </div>
                    {% endfor %}
                    </div>
                </div>
            {% endfor %}
            </div>
            <button class="carousel-control-prev" href="#cardCarousel" role="button" data-slide="prev" style="color: #1f1f1f;">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </button>
            <button class="carousel-control-next" href="#cardCarousel" role="button" data-slide="next" style="color: #1f1f1f;">
                <span class="sr-only">Next</span>
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
            </button>
            </button>
            </div>
            </div>
            </div>

    
{% endblock %}



        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        <script src="script.js"></script>
        <script>
            const showMore = document.getElementById('show-more');
            const showLess = document.getElementById('show-less');
            const cardTextContainer = document.getElementById('card-text-container');
            
            if (cardTextContainer.scrollHeight > cardTextContainer.clientHeight) {
                showMore.style.display = 'block';
            }
            
            showMore.addEventListener('click', (e) => {
                e.stopPropagation();
                cardTextContainer.style.maxHeight = 'none';
                showMore.style.display = 'none';
                showLess.style.display = 'block';
            });
            
            showLess.addEventListener('click', (e) => {
                e.stopPropagation();
                cardTextContainer.style.maxHeight = '10rem';
                showMore.style.display = 'block';
                showLess.style.display = 'none';
            });
            
            $(document).ready(function(){
                $("#featuredCard").css("display", "none");
                $(".miniCard").click(function(){
                    if($(this).hasClass("selectedCard")) {
                        $(this).removeClass("selectedCard");
                        $("#featuredCard").css("display", "none");
                        $("#emptyCard").css("display", "block");
                    } else {
                        $(".selectedCard").removeClass("selectedCard");
                        $(this).addClass("selectedCard");
                        $("#emptyCard").css("display", "none");
                        $("#featuredCard").css("display", "block");
                    }
                });
                $(document).on('change', function() {
                    if($("#deck .selectedCard").length > 0) {
                        $("#emptyCard").css("display", "none");
                        $("#featuredCard").css("display", "block");
                    } else {
                        $("#emptyCard").css("display", "block");
                        $("#featuredCard").css("display", "none");
                    }
                });
            }); 
    
  
        </script>
        <script>
    
            /*    Gift from our friend Eliza, needs modifying for database, it's too late to be starting that I'm going to bed 
            $(document).ready(function(){
                $(".selectedCard").on('click', function(){
                    let cardTitle = $(this).find(".card-title").html();
                    let cardImage = $(this).find("img").attr("src");
                    let cardText = $(this).find(".card-text").html();
                    let cardLink = $(this).find("a").attr("href");
                    let cardUpdated = $(this).find("small").html();
    
                    $("#featuredCard .card-title").html(cardTitle);
                    $("#featuredCard .card-text").html(cardText);
                    $("#featuredCard img").attr("src", cardImage);
                    $("#featuredCard a").attr("href", cardLink);
                    $("#featuredCard small").html(cardUpdated); 
                });
            }); */
        </script>